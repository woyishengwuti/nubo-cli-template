## 通用代码事例

```js
this.$confirm('标题', '', {
  confirmButtonText: '确定',
  cancelButtonText: '取消',
  closeOnPressEscape: false,
  closeOnClickModal: false,
  showClose: false,
  customClass: 'layer-default-confirm'
}).then(() => {

}).catch(() => {

})
```

```js
// 两行的 div.first-line div.second-line
const sCellCode = this.$parent.selectedCell.sCellCode
const title = `<div class="first-line">是否确定将【${sCellCode}】设为退损单元?</div>
              <div  class="second-line">设置后用于存储破损的药品，仅管理员可打开。</div>`

this.$confirm(title, '', {
  confirmButtonText: '确定',
  cancelButtonText: '取消',
  closeOnPressEscape: false,
  closeOnClickModal: false,
  showClose: false,
  dangerouslyUseHTMLString: true,
  customClass: 'layer-default-confirm'
}).then(() => {
  const iCellId = this.$parent.selectedCell.iCellId
  api.setBackUnit(iCellId, type).then(res => {
    if (res.result) {
      this.$message.success('设置成功')
      this.dialogVisible = false
      this.$emit('refresh')
    }
  })
}).catch(() => {

})
```

```js
//每个模块通用代码

// 时间参数信息
computed
// 超时提交数据
sAutoSubmit() {
  return this.$store.state.modules.sAutoSubmit
},
// 超时提交数据
sLockTimeOut() {
  return this.$store.state.modules.sLockTimeOut
},
// 底层数据
UnderylingData() {
  return this.$store.state.core.UnderylingData
},

watch
// 监听是否需要提交数据
sAutoSubmit(val) {
  if (val === 'timeout') {
    console.log('补药页面收到超时提交数据的消息', val)

    // 提交数据
    // if (this.dialogFormVisible && !this.clickBtnYesStatus) {
    // 	//弹层存在 并且此时不处于提交数据状态
    // 	this.clickBtnYes();
    // }
  }
},
// 监听浏览器是否超时，超时后如果存在弹出层则提交数据
sLockTimeOut(val) {
  if (val === 'timeout') {
    console.log('主页告知现在已经到了浏览器设定的超时时间', val)

    // 提交数据
    // if (this.dialogFormVisible && !this.clickBtnYesStatus) {
    // 	//弹层存在 并且此时不处于提交数据状态
    // 	this.clickBtnYes();
    // }
  }
},
UnderylingData(val, oldVal) {
  console.log('数据变化', val, oldVal)
}
```

```js
// 自动提交 - 打开弹出层
this.$store.commit('modules/SET_AUTOSUBMIT', 'open')
// 自动提交 - 打开弹出层
this.$store.commit('modules/SET_AUTOSUBMIT', 'submit')
this.$store.commit('modules/SET_AUTOSUBMIT', 'close')
```

```js
// 模块标题栏目
// 个人中心消息帮助设置模块只显示标题，资源信息则侧边栏显示
// 其余模块标题提交空，资源照常

// 资源
this.$store.commit('modules/SET_BASESRCINFOS', baseSrcInfos)
// 标题
this.$store.commit('modules/SET_TITLE', title)
```


```js
// 大的弹出层基础样式
<el-dialog
  :title="title"
  class="edit-item-dialog custom-dialog-default"
  :visible.sync="dialogVisible"
  top="8.3vh"
  :close-on-click-modal="false"
  :close-on-press-escape="false"
  width="77%"
>
  <!-- 统一使用的头部 -->
    <div slot="title" class="title">
      <div>
        <span class="cell">单元号</span>
        <span class="cell-num sub-font-family">{{ title }}</span>
      </div>
      <div class="right-icon" @click="cancel">
        <svg-icon icon-class="dialog-title-close" />
      </div>
    </div>
</el-dialog>

// 中等弹出层基础样式
<el-dialog
  :title="title"
  class="edit-item-dialog custom-dialog-middle"
  :visible.sync="dialogVisible"
  top="8.3vh"
  :close-on-click-modal="false"
  :close-on-press-escape="false"
  width="52.08%"
>
</el-dialog>

// 小的弹出层基础样式
<el-dialog
  :title="title"
  class="edit-item-dialog custom-dialog-mini"
  :visible.sync="dialogVisible"
  top="calc(200vh / 10.8)"
  :close-on-click-modal="false"
  :close-on-press-escape="false"
  width="calc(600% / 19.2)"
>
</el-dialog>
```

```js
全局防抖

import { throttle } from '@core/utils/utils'

getStocByJP: throttle(function(key) {
  api.getStocByJP({
    searchCode: this.searchVal
  }).then(res => {
    if (res.result) {
      const data = res.data
      data.forEach(v => {
        // 自动出药单元需要显示数量不能超过此节点的库存信息
        if (v.singleInfo) {
          this.$set(v, 'num', 0)
        }

        this.$set(v, 'selected', false)
      })

      // 全部和已选
      this.selected = 0
      this.al = data.length

      this.tableDataApp = data
    }
  })
}, 1000),
```


```js
// 以载荷形式分发 - 更新全局药品信息
this.$store.dispatch('modules/loadStockInfoAsync')

// 以载荷形式分发 - 更新全局药品批号信息
this.$store.dispatch('modules/loadBatchOptions')

sBatchOptions() {
  return this.$store.state.modules.sBatchOptions
}

stockInfo() {
  return this.$store.state.modules.stockInfo
}
```

```js
// 双人核对用法
// 打开双人核对界面
// 为了避免冲突 doubeCheck：双人核对 modifyData：修改数量后双人核对
this.$store.commit('modules/SET_DOUBLECHECKVISIBLE', true)

// 监听结果
// 双人核对结果
doubleCheckResult() {
  return this.$store.state.modules.doubleCheckResult
}

// 全局焦点
globalFocus() {
  return this.$store.state.core.globalFocus
}

// 全局确认事件 globalEnter
globalEnter() {
  return this.$store.state.core.globalEnter
}

watch
// 监听双人核对结果信息
doubleCheckResult(val) {
  if (val) {
    // 核对成功
    this.clickAfterCheck(this.clickLayoutItem)
  }
}

globalEnter() {
  this.clickToLogin()
}
```


```js
<!--通过@hook:updated监听组件的updated生命钩子函数-->
<!--组件的所有生命周期钩子都可以通过@hook:钩子函数名 来监听触发-->
<custom-select @hook:updated="$_handleSelectUpdated" />
```

```js
// 打印

// 第一种使用插件打印
const data = { 'searchData': [{ 'iReportFieldId': 600, 'iReportId': 23, 'sFieldName': 'in_roleId', 'sFieldTxt': '所属角色', 'iFieldWidth': null, 'iFieldType': 0, 'fieldOriType': null, 'iWidgetType': 4, 'iSelectType': null, 'sCascadeFieldName': 'in_account', 'sSql': "select i_role_ID 'value', s_role_name 'text' from base_role_info where i_state=1", 'iDateDefault': null, 'iSum': 0, 'iAverage': 0, 'iShow': 0, 'iSort': 0, 'sDetailArgName': null, 'dCreateTime': '2020-04-08T17:55:12', 'dUpdateTime': '2020-05-21T10:53:12', 'iUpdateBy': 6465, 'data': [{ 'text': '超级管理员', 'value': 1 }, { 'text': 'SYH2', 'i_role_ID': 1, 'value': '10011' }, { 'text': 'test李锐', 'value': '00001' }] }, { 'iReportFieldId': 602, 'iReportId': 23, 'sFieldName': 'in_state', 'sFieldTxt': '状态', 'iFieldWidth': null, 'iFieldType': 0, 'fieldOriType': null, 'iWidgetType': 3, 'iSelectType': null, 'sCascadeFieldName': null, 'sSql': "select 0 'value','禁用' as 'text' union all  select 1 'value','启用' as 'text'", 'iDateDefault': null, 'iSum': 0, 'iAverage': 0, 'iShow': 0, 'iSort': 0, 'sDetailArgName': null, 'dCreateTime': '2020-04-08T17:55:12', 'dUpdateTime': '2020-05-21T10:53:12', 'iUpdateBy': 6465, 'data': [{ 'text': '禁用', 'value': 0 }, { 'text': '启用', 'value': 1 }] }, { 'iReportFieldId': 603, 'iReportId': 23, 'sFieldName': 'in_sex', 'sFieldTxt': '性别', 'iFieldWidth': null, 'iFieldType': 0, 'fieldOriType': null, 'iWidgetType': 3, 'iSelectType': null, 'sCascadeFieldName': null, 'sSql': "select 0 'value','女' as 'text' union all  select 1 'value','男' as 'text'", 'iDateDefault': null, 'iSum': 0, 'iAverage': 0, 'iShow': 0, 'iSort': 0, 'sDetailArgName': null, 'dCreateTime': '2020-04-08T17:55:12', 'dUpdateTime': '2020-05-21T10:53:12', 'iUpdateBy': 6465, 'data': [{ 'text': '女', 'value': 0 }, { 'text': '男', 'value': 1 }] }, { 'iReportFieldId': 604, 'iReportId': 23, 'sFieldName': 'in_cre_time_start', 'sFieldTxt': '开始时间', 'iFieldWidth': null, 'iFieldType': 0, 'fieldOriType': null, 'iWidgetType': 2, 'iSelectType': null, 'sCascadeFieldName': null, 'sSql': '', 'iDateDefault': 4, 'iSum': 0, 'iAverage': 0, 'iShow': 0, 'iSort': 0, 'sDetailArgName': null, 'dCreateTime': '2020-04-08T17:55:12', 'dUpdateTime': '2020-05-21T10:53:12', 'iUpdateBy': 6465, 'data': null }, { 'iReportFieldId': 605, 'iReportId': 23, 'sFieldName': 'in_cre_time_end', 'sFieldTxt': '结束时间', 'iFieldWidth': null, 'iFieldType': 0, 'fieldOriType': null, 'iWidgetType': 2, 'iSelectType': null, 'sCascadeFieldName': null, 'sSql': '', 'iDateDefault': 5, 'iSum': 0, 'iAverage': 0, 'iShow': 0, 'iSort': 0, 'sDetailArgName': null, 'dCreateTime': '2020-04-08T17:55:12', 'dUpdateTime': '2020-05-21T10:53:12', 'iUpdateBy': 6465, 'data': null }], 'colTitles': [{ 'colName': 's_name', 'colTitle': '姓名', 'colWidth': null, 'iSum': 1, 'iAverage': 1, 'sDetailArgName': null, 'colShow': 1 }, { 'colName': 's_account', 'colTitle': '账户', 'colWidth': null, 'iSum': 1, 'iAverage': 1, 'sDetailArgName': null, 'colShow': 1 }, { 'colName': 's_role_name', 'colTitle': '所属角色', 'colWidth': 300, 'iSum': 1, 'iAverage': 1, 'sDetailArgName': null, 'colShow': 1 }, { 'colName': 'i_sex', 'colTitle': '性别', 'colWidth': null, 'iSum': 1, 'iAverage': 1, 'sDetailArgName': null, 'colShow': 1 }, { 'colName': 's_pass_word', 'colTitle': 's_pass_word', 'colWidth': null, 'iSum': 0, 'iAverage': 0, 'sDetailArgName': null, 'colShow': 0 }, { 'colName': 's_card_num', 'colTitle': 's_card_num', 'colWidth': null, 'iSum': 0, 'iAverage': 0, 'sDetailArgName': null, 'colShow': 0 }, { 'colName': 's_phone_num', 'colTitle': 's_phone_num', 'colWidth': null, 'iSum': 0, 'iAverage': 0, 'sDetailArgName': null, 'colShow': 0 }, { 'colName': 's_telephone_num', 'colTitle': 's_telephone_num', 'colWidth': null, 'iSum': 0, 'iAverage': 0, 'sDetailArgName': null, 'colShow': 0 }, { 'colName': 'd_cre_time', 'colTitle': 'd_cre_time', 'colWidth': null, 'iSum': 0, 'iAverage': 0, 'sDetailArgName': null, 'colShow': 0 }, { 'colName': 'i_state', 'colTitle': 'i_state', 'colWidth': null, 'iSum': 0, 'iAverage': 0, 'sDetailArgName': null, 'colShow': 0 }], 'colData': [{ 's_account': '测试用户', 's_pass_word': '123456', 'i_sex': '0', 's_phone_num': '', 's_telephone_num': '', 's_role_name': '超级管理员', 's_card_num': '12345', 'd_cre_time': '2020-03-20 17:39:53.0', 's_name': '测试用户', 'i_state': '1' }, { 's_account': '李四2', 's_pass_word': '123456', 'i_sex': '1', 's_phone_num': '1822665479', 's_telephone_num': '18226649856', 's_role_name': '超级管理员', 's_card_num': '', 'd_cre_time': '2020-03-19 11:53:39.0', 's_name': '李四2', 'i_state': '1' }, { 's_account': '王琪', 's_pass_word': '123456', 'i_sex': '0', 's_phone_num': '', 's_telephone_num': '', 's_role_name': '超级管理员', 's_card_num': '', 'd_cre_time': '2020-04-07 08:41:02.0', 's_name': '王琪', 'i_state': '1' }, { 's_account': '刘翰青lhq', 's_pass_word': '123456', 'i_sex': '1', 's_phone_num': '17601278327', 's_telephone_num': '7571330', 's_role_name': '超级管理员', 's_card_num': '', 'd_cre_time': '2020-04-08 09:27:37.0', 's_name': '刘翰青lhq', 'i_state': '1' }, { 's_account': '角色导入1', 's_pass_word': '123456', 'i_sex': '1', 's_phone_num': '13800000001', 's_telephone_num': '0551-65658888', 's_role_name': '超级管理员', 's_card_num': '', 'd_cre_time': '2020-04-15 18:58:44.0', 's_name': '角色导入1', 'i_state': '1' }, { 's_account': '测试角色时效不可删除', 's_pass_word': '123456', 'i_sex': '1', 's_phone_num': '', 's_telephone_num': '', 's_role_name': '超级管理员', 's_card_num': '', 'd_cre_time': '2020-04-24 11:21:44.0', 's_name': '测试角色时效不可删除', 'i_state': '1' }, { 's_account': 'SYH', 's_pass_word': '123456', 'i_sex': '1', 's_phone_num': '', 's_telephone_num': '', 's_role_name': '超级管理员', 's_card_num': '', 'd_cre_time': '2020-05-12 10:15:13.0', 's_name': 'SYH', 'i_state': '1' }, { 's_account': 'SYH2', 's_pass_word': '123456', 'i_sex': '1', 's_phone_num': '', 's_telephone_num': '', 's_role_name': '超级管理员', 's_card_num': '', 'd_cre_time': '2020-05-14 16:59:26.0', 's_name': 'SYH2', 'i_state': '1' }], 'iPageNum': 10, 'iShowDetail': 0, 'iPrintPreview': 0, 'sPrintTemplate': 'Report-20200413192538246.mrt' }
// 测绘插件打印
this.$stimulsoftPrint.onStyleClick(data.colData)
// globalVar.ipcRenderer.send('KeyDown')

// 第二种手写打印
this.$print.print(this.$refs.Print)
```